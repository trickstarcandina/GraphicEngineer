#include <GL/freeglut.h>
#include <math.h>

/* Khai bao du lieu bitmap 8x13
cua 26 ki tu trong bang chu cai: ABCDEFGHIJKLMNOPQRSTUVWXYZ
va ki tu dau cach */
GLubyte fontdata[][13] = {
    {0x00, 0x00, 0xc3, 0xc3, 0xc3, 0xc3, 0xff, 0xc3, 0xc3, 0xc3, 0x66, 0x3c, 0x18},
    {0x00, 0x00, 0xfe, 0xc7, 0xc3, 0xc3, 0xc7, 0xfe, 0xc7, 0xc3, 0xc3, 0xc7, 0xfe},
    {0x00, 0x00, 0x7e, 0xe7, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xe7, 0x7e},
    {0x00, 0x00, 0xfc, 0xce, 0xc7, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc7, 0xce, 0xfc},
    {0x00, 0x00, 0xff, 0xc0, 0xc0, 0xc0, 0xc0, 0xfc, 0xc0, 0xc0, 0xc0, 0xc0, 0xff},
    {0x00, 0x00, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xfc, 0xc0, 0xc0, 0xc0, 0xff},
    {0x00, 0x00, 0x7e, 0xe7, 0xc3, 0xc3, 0xcf, 0xc0, 0xc0, 0xc0, 0xc0, 0xe7, 0x7e},
    {0x00, 0x00, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xff, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3},
    {0x00, 0x00, 0x7e, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x7e},
    {0x00, 0x00, 0x7c, 0xee, 0xc6, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06},
    {0x00, 0x00, 0xc3, 0xc6, 0xcc, 0xd8, 0xf0, 0xe0, 0xf0, 0xd8, 0xcc, 0xc6, 0xc3},
    {0x00, 0x00, 0xff, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0},
    {0x00, 0x00, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xdb, 0xff, 0xff, 0xe7, 0xc3},
    {0x00, 0x00, 0xc7, 0xc7, 0xcf, 0xcf, 0xdf, 0xdb, 0xfb, 0xf3, 0xf3, 0xe3, 0xe3},
    {0x00, 0x00, 0x7e, 0xe7, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xe7, 0x7e},
    {0x00, 0x00, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xfe, 0xc7, 0xc3, 0xc3, 0xc7, 0xfe},
    {0x00, 0x00, 0x3f, 0x6e, 0xdf, 0xdb, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0x66, 0x3c},
    {0x00, 0x00, 0xc3, 0xc6, 0xcc, 0xd8, 0xf0, 0xfe, 0xc7, 0xc3, 0xc3, 0xc7, 0xfe},
    {0x00, 0x00, 0x7e, 0xe7, 0x03, 0x03, 0x07, 0x7e, 0xe0, 0xc0, 0xc0, 0xe7, 0x7e},
    {0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0xff},
    {0x00, 0x00, 0x7e, 0xe7, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3},
    {0x00, 0x00, 0x18, 0x3c, 0x3c, 0x66, 0x66, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3},
    {0x00, 0x00, 0xc3, 0xe7, 0xff, 0xff, 0xdb, 0xdb, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3},
    {0x00, 0x00, 0xc3, 0x66, 0x66, 0x3c, 0x3c, 0x18, 0x3c, 0x3c, 0x66, 0x66, 0xc3},
    {0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x3c, 0x3c, 0x66, 0x66, 0xc3},
    {0x00, 0x00, 0xff, 0xc0, 0xc0, 0x60, 0x30, 0x7e, 0x0c, 0x06, 0x03, 0x03, 0xff},
    {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00} };

void makeCharactersRaster() // Ham khoi tao danh sach hien thi cho tung ki tu
{
    glPixelStorei(GL_UNPACK_ALIGNMENT, 1); // Dat che do luu tru pixel (moi hang 8 bit)
    for (int i = 'A'; i < 'Z'; i++)
    {
        glNewList(i, GL_COMPILE); // Chi dinh ten danh sach moi va che do bien dich (cac lenh chi duoc bien dich, khong thuc thi ngay)
        glBitmap(8, 13, 0.0, 2.0, 10.0, 0.0, fontdata[i - 'A']); // Luu hinh anh nhi phan cua ki tu
        glEndList(); // Ket thuc danh sach
    }
    glNewList(' ', GL_COMPILE);
    glBitmap(8, 13, 0.0, 2.0, 10.0, 0.0, fontdata[26]);
    glEndList();
}

void printString(const char* string) // Ham in chuoi ki tu
{
    const char* c;
    for (c = string; *c != '\0'; c++) glCallList(*c); // Thuc thi tung danh sach hien thi ung voi ki tu cua chuoi
}

void initGLCharacter() // Ham khoi tao thong so
{
    glClearColor(1.0f, 1.0f, 1.0f, 1.0f);
    //glClearColor(0.0f, 0.0f, 0.0f, 1.0f); // Xoa bo dem mau R=0, G=0, B=0, Anpha=1
    glOrtho(-640, 640, -480, 480, -1, 1); // Phep chieu de hien thi doi tuong
    makeCharactersRaster(); // Goi ham khoi tao danh sach hien thi cho tung ki tu
}

void mydisplayCharacter() // Ham hien thi text
{
    glClear(GL_COLOR_BUFFER_BIT); // Xoa bo dem mau cua cac gia tri dat truoc da duoc kich hoat
    glColor3f(1.0, 0.0, 0.0); // Dat mau hien tai cho doi tuong R=1, G=0, B=0

    glRasterPos2i(-250, 100); // Chi dinh vi tri raster cho cac phuong thuc pixel
    printString("HIEN THI KI TU DANG BITMAP"); // Goi ham in chuoi
    glRasterPos2i(-500, 0);
    printString("A B C D E F G H I J K L M N O P Q R S T U V W X Y Z");

    glViewport(0, 0, 640, 480); // Dat khung nhin
    glFlush(); // Buoc thuc hien cac lenh GL trong thoi gian huu han
}

void CharacterMethod()
{
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB); // Khoi tao che do hien thi ban dau (mat na bit cho mot cua so dem duy nhat, che do cua so RGB)
    glutInitWindowSize(640, 480); // Dat kich thuoc cua so ban dau
    glutInitWindowPosition(0, 0); // Dat vi tri cua so ban dau
    glutCreateWindow("DEMO THUAT TOAN SINH KI TU - Bitmap Character"); // Tao cua so cap cao nhat
    initGLCharacter(); // Goi ham khoi tao thong so
    glutDisplayFunc(mydisplayCharacter); // Goi ham hien thi text cho cua so hien tai
    glutSetOption(GLUT_ACTION_ON_WINDOW_CLOSE, GLUT_ACTION_GLUTMAINLOOP_RETURNS);
    //cach 1
    glutMainLoop(); // Buoc vao vong lap xu li su kien GLUT
    //cach 2
    //glutMainLoopEvent();
}
